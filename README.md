# vk_ranking
Профильное задание на вакансию ML-инженера.

В ноутбуке ranking.ipynb приведен и описан весь пайплайн обучения. Удалось получить NDCG = 0.46.

В папке ranking содержатся файлы проекта (по сути, тот же ноутбук, но в формате файлов .py и с некоторым консольным интерфейсом) и Dockerfile. 

Что делал (кратко):
1. Предобработал обучающие данные: удалил повторяющиеся строки, константные признаки, почистил пары признаков с высокой взаимной корреляцией. Также нарисовал пару графиков:

Распределение таргет-переменной:
![image](https://github.com/Vladislav-IS/vk_ranking/assets/74904348/68eef6bd-0590-4f14-9d45-1b54f7a2cfb1)

Распределение объектов в тренировочной и тестовой выборках (после декомпозиции признаков):
![image](https://github.com/Vladislav-IS/vk_ranking/assets/74904348/faa8ec87-ef8f-4b9d-9a1a-0eb28739b83c)

2. Обучил модель (решал задачу ранжирования как задачу бинарной классификации с учетом дисбаланса классов, использовал библтотеку catboost).
3. Рассчитал NDCG. Я группировал тестовую выборку по search_id и считал NDCG внутри каждой подгруппы; при этом ввел несколько условий:
- если по какому-то search_id нет релевантных запросов и все таргет-переменные равны 0, я не учитывал такой запрос в общем результате (потому что нет смысла считать метрику для нерелевантных данных);
- если запрос с каким-то search_id был в выборке всего один, брал в качестве NCDG 1, если таргет и предсказание были равны, и 0, если не равны;
- итоговая NDCG - средняя для всех подгрупп.

В папке ranking также лежит файл обученной модели (под именем last).

Docker-контейнер следует запускать с опцией `-it`.
